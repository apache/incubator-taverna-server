<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Taverna Server ${project.version} Administration Interface</title>
<link id="admin" href="admin" />
<script type="text/javascript" src="admin/static/jquery-1.8.0.min.js"></script>
<script type="text/javascript" src="admin/static/jquery-ui-1.8.23.custom.min.js"></script>
<script type="text/javascript" src="admin/static/admin.js"></script>
<link href="admin/static/jquery-ui-1.8.23.custom.css" rel="stylesheet" type="text/css" />

</head>
<body>
<img height="70" style="float:left" src="admin/static/t2cogs.png">
<h1>Taverna Server ${project.version} Administration Interface</h1>
<br clear="left"/>
<div id="body">
<ul>
  <li><a href="#t-global">Global Settings</a></li>
  <li><a href="#t-users">Users</a></li>
  <li><a href="#t-workflows">Workflows</a></li>
  <li><a href="#t-usage">Usage Records</a></li>
  <li><a href="#t-worker">Local Worker Configuration</a></li>
</ul>
  
<div id="t-global">
<label title="The number of invocations of the main interface webapp that have been done. Be aware that one service call can result in many invocations due to resource resolution." for="invokationCount">Invocation Count:</label>
<span title="The number of invocations of the main interface webapp that have been done. Be aware that one service call can result in many invocations due to resource resolution." id="invokationCount">0</span>
<br>
<label title="The number of runs that currently exist." for="runCount">Run Count:</label>
<span title="The number of runs that currently exist." id="runCount">0</span>
<br>
<label title="The number of runs that are currently operating." for="operatingCount">Operating Run Count:</label>
<span title="The number of runs that are currently operating." id="operatingCount">0</span>
<br>
<label title="Whether workflow runs should create provenance traces by default. Users can explicitly override this." for="generateProvenance">Generate Provenance by Default</label>
<input type="checkbox" id="generateProvenance" />
<br>
<label title="The time it took for the back-end engine to start up, in seconds. Should usually be short." for="startupTime">Back-End Startup Time (seconds):</label>
<span title="The time it took for the back-end engine to start up, in seconds. Should usually be short." id="startupTime">0</span>
<br>
<label title="The exit code from the last time the back-end was shut down. Blank if the back end has never been shut down while the current webapp instance is running (i.e., since the last boot of the container)." for="lastExitCode">Back-End Last Exit Code:</label>
<span title="The exit code from the last time the back-end was shut down. Blank if the back end has never been shut down while the current webapp instance is running (i.e., since the last boot of the container)." id="lastExitCode"></span>
<p>
<label title="Whether new workflow runs should be created. Disabling this does not prevent existing runs from executing." for="allowNew">Allow New Runs</label>
<input type="checkbox" id="allowNew" />
<label title="Whether to record the workflows being run by users. Very noisy due to length of workflow documents, occasionally useful." for="logWorkflows">Log Executed Workflows</label>
<input type="checkbox" id="logWorkflows" />
<label title="Whether to record exceptions generated by users in the code (as well as converting them to faults and error responses). Useful for debugging, but noisy." for="logFaults">Log User Exceptions</label>
<input type="checkbox" id="logFaults" />
<p>
<label title="The maximum number of workflow runs that can exist at once, in any state." for="runLimit">Maximum Simultaneous Existing Workflow Runs</label>
<input title="The maximum number of workflow runs that can exist at once, in any state." id="runLimit" size="3" />
<br>
<label title="The maximum number of workflow runs that can be executing at once." for="operatingLimit">Maximum Simultaneous Executing Workflow Runs</label>
<input title="The maximum number of workflow runs that can be executing at once." id="operatingLimit" size="3" />
<br>
<label title="How long to allow a workflow to execute for by default (clients can change this), in minutes." for="defaultLifetime">Default Run Lifetime (minutes)</label>
<input title="How long to allow a workflow to execute for by default (clients can change this), in minutes." id="defaultLifetime" size="7" />
</div><!-- t-global -->

<div id="t-users">
<table id="userList">
  <tr><th>Username<th>System Username</tr>
</table>
<h3>Add a user</h3>
<table border=1>
  <tr>
    <td><label title="The user name to create." for="newUsername">Username</label>
    <td><input title="The user name to create." size=12 id="newUsername" />
  </tr>
  <tr>
    <td><label title="The password to use for the user." for="newPassword">Password</label>
    <td><input title="The password to use for the user." size=12 id="newPassword" type="password"/>
  </tr>
  <tr>
    <td><label title="The system account to run the user's workflows in; leave blank for the default." for="newSysID">System ID</label>
    <td><input title="The system account to run the user's workflows in; leave blank for the default." size=12 id="newSysID" />
  </tr>
  <tr><td colspan=2>
    <label title="Whether to allow this user to log in at all." for="newEnabled">Enabled</label>
    <input type="checkbox" id="newEnabled" />
    <label title="Whether the user has administrative privileges (can see all workflow runs, can access the administration page)." for="newAdmin">Admin</label>
    <input type="checkbox" id="newAdmin" />
  </td></tr>
  <tr><td colspan=2>
    <button id="makeNewUser">Create a new user</button>
  </td></tr>
</table>
</div><!-- t-users -->

<div id="t-workflows">
<label title="Workflow URIs to limit execution to." for="workflows">Workflow URIs (one per line)</label>
<br>
<textarea title="Workflow URIs to limit execution to." rows="5" cols="60" id="workflows"></textarea>
<p>
<button id="saveWorkflows">Save</button> <button id="refreshWorkflows">Refresh</button>
</div>

<div id="t-usage">
Download <a href="#" id="ur">usage records</a> (warning: may be slow!)
<p>
<label title="The name of a file to write usage records to. Note that this file will end up containing many XML documents concatenated together; it is up to you to split them up as necessary. Each record is only written as it is generated; this does not produce historic data." for="usageRecordDumpFile">Usage Record Dump File</label>
<input title="The name of a file to write usage records to. Note that this file will end up containing many XML documents concatenated together; it is up to you to split them up as necessary. Each record is only written as it is generated; this does not produce historic data." id="usageRecordDumpFile" size="50" />
</div><!-- t-usage -->

<div id="t-worker">
  <div id="a-worker">

    <h3><a href="#">Subprocess Implementation Control</a></h3>
    <div>
      <table>
	<tr>
	  <td> <label title="The full path of the Java executable to use. Normally set correct by default." for="javaBinary">Java Executable (for subprocesses):</label> </td>
	  <td> <input title="The full path of the Java executable to use. Normally set correct by default." id="javaBinary" size="80" /> </td>
	</tr>
	<tr>
	  <td> <label title="The full path of the secure subprocess fork engine to use. Normally set correct by default." for="serverForkerJar">Subprocess Factory JAR:</label> </td>
	  <td> <input title="The full path of the secure subprocess fork engine to use. Normally set correct by default." id="serverForkerJar" size="80" /> </td>
	</tr>
	<tr>
	  <td> <label title="The full path of a file containing the credentials to use with sudo. Leave blank to use a password-less connection (see documentation for how to configure)." for="runasPasswordFile">File with password for sudo:</label> </td>
	  <td> <input title="The full path of a file containing the credentials to use with sudo. Leave blank to use a password-less connection (see documentation for how to configure)." id="runasPasswordFile" size="80" /> </td>
	</tr>
	<tr>
	  <td> <label title="The full path of the user filesystem access and workflow initiation engine to use. Normally set correct by default." for="serverWorkerJar">User Filesystem Access JAR:</label> </td>
	  <td> <input title="The full path of the user filesystem access and workflow initiation engine to use. Normally set correct by default." id="serverWorkerJar" size="80" /> </td>
	</tr>
	<tr>
	  <td> <label title="The full path of the workflow engine executable. Normally set correctly by default." for="executeWorkflowScript">Workflow Engine Executable:</label> </td>
	  <td> <input title="The full path of the workflow engine executable. Normally set correctly by default." id="executeWorkflowScript" size="80" /> </td>
	</tr>
      </table>
    </div>

    <h3><a href="#">Worker Registration Control</a></h3>
    <div>
      <label title="The machine hosting the RMI registry. WARNING: changing this will probably break your configuration! Contact the myGrid team for help before adjusting!" for="registryHost">Registry Host</label>
      <input title="The machine hosting the RMI registry. WARNING: changing this will probably break your configuration! Contact the myGrid team for help before adjusting!" id="registryHost" size="20" />
      <label title="The port number the RMI registry. WARNING: changing this will probably break your configuration! Contact the myGrid team for help before adjusting!" for="registryPort">Port</label>
      <input title="The port number the RMI registry. WARNING: changing this will probably break your configuration! Contact the myGrid team for help before adjusting!" id="registryPort" size="5" />
      <br>
      <label title="The full path of the RMI registry implementation JAR file. WARNING: changing this will probably break your configuration! Contact the myGrid team for help before adjusting!" for="registryJar">RMI Registry JAR</label>
      <input title="The full path of the RMI registry implementation JAR file. WARNING: changing this will probably break your configuration! Contact the myGrid team for help before adjusting!" id="registryJar" size="80" />
      <br>
      <label title="The time to wait (in seconds) for the back-end processes to boot and register themselves with the RMI registry. Busy machines may need a longer value here." for="registrationWaitSeconds">Time to wait for registration (seconds)</label>
      <input title="The time to wait (in seconds) for the back-end processes to boot and register themselves with the RMI registry. Busy machines may need a longer value here." id="registrationWaitSeconds" size="5" />
      <br>
      <label title="How long to wait (in milliseconds) between probes to the registry to detect the registration of a back-end process." for="registrationPollMillis">Time to wait between polling to
      detect registration (milliseconds)</label>
      <input title="How long to wait (in milliseconds) between probes to the registry to detect the registration of a back-end process." id="registrationPollMillis" size="5" />
    </div>

    <h3><a href="#">System User/Factory ID Mapping</a></h3>
    <div>
      <table title="The mapping of system user IDs to factory identifiers (used in the RMI registry). Note that this is read-only." id="factoryProcessMapping" border="1">
      </table>
    </div>

   	<h3><a href="#">Extra Workflow Engine Configuration</a></h3>
   	<div>
   		<h4>System Properties</h4>
   		<table id="extraArguments-prop">
   		<tr><td></td><td><button title="Add a system property to pass to the back-end engine." id="extra-prop-add">Add System Property</button></td></tr>
   		</table>
   		<h4>Environment Variables</h4>
   		<table id="extraArguments-env">
   		<tr><td></td><td><button title="Add an environment variable to pass to the back-end engine." id="extra-env-add">Add Environment Variable</button></td></tr>
   		</table>
   		<h4>Java Runtime Configuration</h4>
   		<table id="extraArguments-runtime">
   		<tr><td></td><td><button title="Add a Java runtime parameter (e.g., Xmx=400m to set the memory usage limit to 400MB) to pass to the back-end engine. Note the lack of a leading '-' character!" id="extra-run-add">Add Runtime Configuration</button></td></tr>
   		</table>
   	</div>

  </div><!-- a-worker -->
</div><!-- t-worker -->

</div>

<hr>
<address>Donal Fellows / University of Manchester</address>

<!-- DIALOG BOXES -->
<div id="dialog-confirm" title="Delete user?" style="display: none">
  <p>
  <span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>
  This user will be permanently deleted from the system. Are you sure?
  </p>
</div>

<div id="dialog-password" title="Change password?" style="display: none">
  <p>
  <span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>
  This will permanently change the user's password. Make sure you wish
  to do this.
  </p>
  <p>
  <input title="New password" id="change-password" type="password" size="12" />
  <br>
  Please repeat it to be sure...
  <br>
  <input title="New password (again)" id="change-password2" type="password" size="12" />
  </p>
</div>

<div id="dialog-environment" title="Set environment variable?" style="display: none">
  <p>
  <span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>
  Set an environment variable to be passed to the workflow engine.
  </p>
  <p>
  <input title="Environment variable name" id="env-key" size="15" /> =
  <input title="Environment variable value" id="env-value" size="20" />
  </p>
</div>

<div id="dialog-runtime" title="Set runtime configuration?" style="display: none">
  <p>
  <span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>
  Set a runtime parameter (e.g., -Xmx400m for a 400MB memory limit) for the Java runtime.
  </p>
  <p>
  <input title="Java runtime configuration parameter" id="runtime-value" size="20" />
  </p>
</div>

<div id="dialog-property" title="Set runtime property?" style="display: none">
  <p>
  <span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>
  Set a configuration property for the Java runtime.
  </p>
  <p>
  <input title="System property name" id="prop-key" size="15" /> =
  <input title="System property value" id="prop-value" size="20" />
  </p>
</div>

</body>
</html>
